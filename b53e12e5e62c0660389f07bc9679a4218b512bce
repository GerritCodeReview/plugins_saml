{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "ca2758c3_527658c5",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 17,
      "author": {
        "id": 1063024
      },
      "writtenOn": "2023-09-04T15:19:46Z",
      "side": 1,
      "message": "This is true for this plugin/application interaction, however SamlMembership still uses uses a header to pass the display name. According to the comments this is done for LDAP syncing. I don\u0027t know if this is an issue, but should we need to address it, it can be done in a separate change.\n\nAny concerns?",
      "revId": "b53e12e5e62c0660389f07bc9679a4218b512bce",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d1b0c3d4_a401c63b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2023-09-05T07:38:10Z",
      "side": 1,
      "message": "I believe we should move this to stable-3.2, even if the version is EOL, otherwise users won\u0027t be able to use the SAML integration properly for 7 versions versions between v3.2 and v3.9",
      "revId": "b53e12e5e62c0660389f07bc9679a4218b512bce",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "139c7352_902dc21f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2023-09-05T08:50:27Z",
      "side": 1,
      "message": "+1",
      "parentUuid": "d1b0c3d4_a401c63b",
      "revId": "b53e12e5e62c0660389f07bc9679a4218b512bce",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b1f5b016_ff3e39e8",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/saml/SamlWebFilter.java",
        "patchSetId": 2
      },
      "lineNbr": 182,
      "author": {
        "id": 1063024
      },
      "writtenOn": "2023-09-04T15:19:46Z",
      "side": 1,
      "message": "The test passes without setting the request context, but when running the app it\u0027s required. I suppose this is because we inject the same admin GerritApi instance. Anyway, this call isn\u0027t covered by regression.",
      "revId": "b53e12e5e62c0660389f07bc9679a4218b512bce",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9426ce59_4630bc7e",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/saml/SamlWebFilter.java",
        "patchSetId": 2
      },
      "lineNbr": 182,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2023-09-04T16:13:37Z",
      "side": 1,
      "message": "Can you maybe add a comment explaining why we need to make this call after the `doFilter`?\n\nJust to double check this means that:\n1. we will create the user with the wrong display name and then correct it\n2. every time the user will login, we will do this call\n\nRegarding 2: is the All-Users modified everytime or if display name is unchanged this translates in a noop?\n\nIn any case, I think it might not be a big deal since you don\u0027t normally logout when using SAML.",
      "revId": "b53e12e5e62c0660389f07bc9679a4218b512bce",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "580e3b78_3d4f6a0d",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/saml/SamlWebFilter.java",
        "patchSetId": 2
      },
      "lineNbr": 182,
      "author": {
        "id": 1063024
      },
      "writtenOn": "2023-09-04T20:58:07Z",
      "side": 1,
      "message": "Re: `doFilter`, this call has to happen after said method because before it our user won\u0027t have an account, so the GerritApi call will fail.\n\nWith respect to your other points:\n1. I think this is the case, yes. However in the next change in this chain we don\u0027t set the header anymore, so this call would then set it for the first time. FWIW in both cases this all happens before the page is rendered, so it should be transparent to the user.\n2. Yes, that\u0027s correct. We could check what the name is first, and only do the update if it differs. WDYT?",
      "parentUuid": "9426ce59_4630bc7e",
      "revId": "b53e12e5e62c0660389f07bc9679a4218b512bce",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "07c78c82_abf303a3",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/saml/SamlWebFilter.java",
        "patchSetId": 2
      },
      "lineNbr": 184,
      "author": {
        "id": 1063024
      },
      "writtenOn": "2023-09-04T20:58:07Z",
      "side": 1,
      "message": "Is there a terser way to get `Account.Id`?",
      "revId": "b53e12e5e62c0660389f07bc9679a4218b512bce",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d901c933_e4e53267",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/saml/SamlWebFilter.java",
        "patchSetId": 2
      },
      "lineNbr": 184,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2023-09-05T08:50:27Z",
      "side": 1,
      "message": "The way you did it is ok",
      "parentUuid": "07c78c82_abf303a3",
      "revId": "b53e12e5e62c0660389f07bc9679a4218b512bce",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3764531e_9b5670c5",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/saml/SamlWebFilter.java",
        "patchSetId": 2
      },
      "lineNbr": 185,
      "author": {
        "id": 1063024
      },
      "writtenOn": "2023-09-04T16:11:16Z",
      "side": 1,
      "message": "This call has to happen _after_ `doFilter`. This is because if we do it before, the user won\u0027t have been authenticated and their account will not be available.\n\nI originally had this in another branch, but that made it difficult to find the condition to trigger this call. Doing it here means it\u0027s done once after a successful login.",
      "revId": "b53e12e5e62c0660389f07bc9679a4218b512bce",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5d1eaa5e_12eb3e78",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/saml/SamlWebFilterIT.java",
        "patchSetId": 2
      },
      "lineNbr": 49,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2023-09-05T07:40:21Z",
      "side": 1,
      "message": "Can we set some special characters as display name?\nThe issue was precisely about the inability to store them to the account full name safely without losses, so we can make sure that happens here.",
      "range": {
        "startLine": 49,
        "startChar": 29,
        "endLine": 49,
        "endChar": 60
      },
      "revId": "b53e12e5e62c0660389f07bc9679a4218b512bce",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1b807073_9a084c53",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/saml/SamlWebFilterIT.java",
        "patchSetId": 2
      },
      "lineNbr": 49,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2023-09-05T08:50:27Z",
      "side": 1,
      "message": "+1",
      "parentUuid": "5d1eaa5e_12eb3e78",
      "range": {
        "startLine": 49,
        "startChar": 29,
        "endLine": 49,
        "endChar": 60
      },
      "revId": "b53e12e5e62c0660389f07bc9679a4218b512bce",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}